<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>用户增删 | 炼丹小本本</title>
    <meta name="generator" content="VuePress 1.9.8">
    
    <meta name="description" content=" ">
    
    <link rel="preload" href="/assets/css/0.styles.5cb60a5d.css" as="style"><link rel="preload" href="/assets/js/app.b3fe3ba4.js" as="script"><link rel="preload" href="/assets/js/2.cfef0441.js" as="script"><link rel="preload" href="/assets/js/11.4bab1ac6.js" as="script"><link rel="preload" href="/assets/js/7.58b74439.js" as="script"><link rel="prefetch" href="/assets/js/10.438ffba0.js"><link rel="prefetch" href="/assets/js/12.2f4b41ac.js"><link rel="prefetch" href="/assets/js/13.0aeb395e.js"><link rel="prefetch" href="/assets/js/14.3a0b5387.js"><link rel="prefetch" href="/assets/js/15.dab8436a.js"><link rel="prefetch" href="/assets/js/16.835e25b2.js"><link rel="prefetch" href="/assets/js/17.efd9d216.js"><link rel="prefetch" href="/assets/js/18.d632e635.js"><link rel="prefetch" href="/assets/js/19.52991b17.js"><link rel="prefetch" href="/assets/js/20.da6bc2c8.js"><link rel="prefetch" href="/assets/js/21.56851f4a.js"><link rel="prefetch" href="/assets/js/22.e6e286a5.js"><link rel="prefetch" href="/assets/js/23.a6f26e8a.js"><link rel="prefetch" href="/assets/js/24.ca8828db.js"><link rel="prefetch" href="/assets/js/25.4790468d.js"><link rel="prefetch" href="/assets/js/26.b14f5887.js"><link rel="prefetch" href="/assets/js/27.95c8a095.js"><link rel="prefetch" href="/assets/js/28.75ba33b0.js"><link rel="prefetch" href="/assets/js/29.bf29640d.js"><link rel="prefetch" href="/assets/js/3.f8bcfb9e.js"><link rel="prefetch" href="/assets/js/30.7c6729ab.js"><link rel="prefetch" href="/assets/js/31.967dfba2.js"><link rel="prefetch" href="/assets/js/32.23e576c6.js"><link rel="prefetch" href="/assets/js/4.c74e7165.js"><link rel="prefetch" href="/assets/js/5.ca9b8247.js"><link rel="prefetch" href="/assets/js/6.e34411cc.js"><link rel="prefetch" href="/assets/js/8.a52f8de6.js"><link rel="prefetch" href="/assets/js/9.ed221136.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5cb60a5d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">炼丹小本本</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Notes" class="dropdown-title"><span class="title">Notes</span> <span class="arrow down"></span></button> <button type="button" aria-label="Notes" class="mobile-dropdown-title"><span class="title">Notes</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/basic_operations_of_linux/index.html" class="nav-link">
  《Linux基操》
</a></li><li class="dropdown-item"><!----> <a href="/programming_magic/index.html" class="nav-link">
  《编程奇技淫巧》
</a></li></ul></div></div> <a href="https://github.com/zfhxi/Alchemy-Handbook" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Notes" class="dropdown-title"><span class="title">Notes</span> <span class="arrow down"></span></button> <button type="button" aria-label="Notes" class="mobile-dropdown-title"><span class="title">Notes</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/basic_operations_of_linux/index.html" class="nav-link">
  《Linux基操》
</a></li><li class="dropdown-item"><!----> <a href="/programming_magic/index.html" class="nav-link">
  《编程奇技淫巧》
</a></li></ul></div></div> <a href="https://github.com/zfhxi/Alchemy-Handbook" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/basic_operations_of_linux/" aria-current="page" class="sidebar-link">《Linux基操》</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>深度学习环境配置</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Linux系统配置</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/basic_operations_of_linux/Linux系统配置/01-linux_static_ip.html" class="sidebar-link">Linux静态IP设定</a></li><li><a href="/basic_operations_of_linux/Linux系统配置/02-server_iptables_simple.html" class="sidebar-link">服务器iptables规则配置简单版</a></li><li><a href="/basic_operations_of_linux/Linux系统配置/03-user_add_del.html" class="active sidebar-link">用户增删</a></li><li><a href="/basic_operations_of_linux/Linux系统配置/04-campus_network.html" class="sidebar-link">校园内网联网</a></li><li><a href="/basic_operations_of_linux/Linux系统配置/05-linux_mount_disk.html" class="sidebar-link">Linux挂载硬盘</a></li><li><a href="/basic_operations_of_linux/Linux系统配置/06-linux_cpu_freq.html" class="sidebar-link">Linux下CPU频率调整</a></li><li><a href="/basic_operations_of_linux/Linux系统配置/07-linux_clash.html" class="sidebar-link">Linux下使用clash代理</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>效率神器</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Shell零碎脚本</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>其他</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="用户增删"><a href="#用户增删" class="header-anchor">#</a> 用户增删</h1> <h2 id="用户账号管理-root权限下操作"><a href="#用户账号管理-root权限下操作" class="header-anchor">#</a> 用户账号管理（root权限下操作）</h2> <h3 id="useradd命令创建用户"><a href="#useradd命令创建用户" class="header-anchor">#</a> useradd命令创建用户</h3> <p>选项：</p> <p>（红色背景框代表该选项为常用项）</p> <ul><li>-c：指定一段注释性描述。</li> <li>-m：用户主目录（家目录）</li> <li>-M：用户没有家目录</li> <li>-d：指定用户主目录，如果此目录不存在，则同时使用-m选项，可以创建主目录。</li> <li>-g：指定用户所属的主用户组。</li> <li>-G：指定用户所属的附加群组。</li> <li>-n：取消建立以用户名称为名的群组。</li> <li>-s：指定用户的登录Shell。</li> <li>-u：指定用户的uid用户号，如果同时有-o选项，则可以重复使用其他用户的标识号。需要说明的是，设定ID值时尽量要大于500，以免冲突。因为Linux安装后会建立一些特殊用户，一般0到499之间的值留给bin、mail这样的系统账号。</li> <li>-e：指定的日期是帐号失效的日期，日期格式YYYY-MM-DD</li></ul> <p>more：<a href="https://linux.die.net/man/8/useradd" target="_blank" rel="noopener noreferrer">https://linux.die.net/man/8/useradd<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>示例：</p> <p>1）创建用户：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 创建一个用户$username，其中-d和-m选项用来为登录名$username产生一个主目录 /home/$username</span>
<span class="token function">useradd</span> <span class="token parameter variable">-d</span> /home/<span class="token variable">$username</span> <span class="token parameter variable">-m</span> <span class="token variable">$username</span>

<span class="token comment">#新建一个用户$username，该用户的登录Shell是 /bin/bash，它属于$group1用户组，同时又属于$group2和$group3用户组，其中$group1用户组是其主组。</span>
<span class="token function">useradd</span> <span class="token parameter variable">-s</span> /bin/bash <span class="token parameter variable">-g</span> <span class="token variable">$group1</span> <span class="token parameter variable">-G</span> <span class="token variable">$group2</span>,<span class="token variable">$group3</span> <span class="token variable">$username</span>

<span class="token comment"># 为其指定登录密码</span>
<span class="token function">passwd</span> <span class="token variable">$username</span>
</code></pre></div><p>2）因此创建一个新用户，可以一次执行如下命令：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">useradd</span> <span class="token parameter variable">-m</span> <span class="token parameter variable">-d</span> /home/<span class="token variable">$username</span> <span class="token parameter variable">-s</span> /bin/bash <span class="token variable">$username</span>
</code></pre></div><p>3）如果新建用户要同时将用户加入组的话：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">useradd</span> <span class="token parameter variable">-m</span> <span class="token parameter variable">-d</span> /home/<span class="token variable">$username</span> <span class="token parameter variable">-s</span> /bin/bash <span class="token parameter variable">-g</span> <span class="token variable">$group1</span>-G <span class="token variable">$group2</span>,<span class="token variable">$group3</span> <span class="token variable">$username</span>
</code></pre></div><h3 id="usermod修改用户"><a href="#usermod修改用户" class="header-anchor">#</a> usermod修改用户</h3> <p>选项</p> <ul><li>-c：修改用户帐号的备注文字</li> <li>-d：修改用户登入时的目录；</li> <li>-e：修改帐号的有效期限；</li> <li>-f：修改在密码过期后多少天即关闭该帐号；</li> <li>-g：修改用户所属的群组；</li> <li>-G：修改用户所属的附加群组；</li> <li>-l：修改用户帐号名称；</li> <li>-L：锁定用户密码，使密码无效；</li> <li>-s：修改用户登入后所使用的shell；</li> <li>-u：修改用户UID；</li> <li>-U：解除密码锁定。</li></ul> <p>more：<a href="https://linux.die.net/man/8/usermod" target="_blank" rel="noopener noreferrer">https://linux.die.net/man/8/usermod<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>示例：</p> <p>1）追加用户的附加组</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 查看用户所属组</span>
<span class="token function">groups</span> <span class="token variable">$username</span> <span class="token comment"># or cat /etc/group</span>
<span class="token comment"># 追加组，无-a选项则代表重设用户的群组</span>
<span class="token function">usermod</span> <span class="token parameter variable">-a</span> <span class="token parameter variable">-G</span> <span class="token variable">$groupxxx</span> <span class="token variable">$username</span>
</code></pre></div><p>2）修改用户名称$username为$newusername</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">usermod</span> <span class="token parameter variable">-l</span> <span class="token variable">$newusername</span> <span class="token variable">$username</span>
</code></pre></div><p>3）锁定用户$username、解除锁定</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">usermod</span> <span class="token parameter variable">-L</span> <span class="token variable">$username</span> <span class="token comment">#锁定</span>
<span class="token function">usermod</span> <span class="token parameter variable">-U</span> <span class="token variable">$username</span> <span class="token comment">#解除</span>
</code></pre></div><p>4）修改$username的登入后的shell</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">usermod</span> <span class="token parameter variable">-s</span> /sbin/nologin <span class="token variable">$username</span> <span class="token comment">#可实现禁止ssh登录，但ftp还可以访问</span>
<span class="token function">usermod</span> <span class="token parameter variable">-s</span> /bin/bash <span class="token variable">$username</span> <span class="token comment">#更改用户默认shell为/bin/bash</span>
</code></pre></div><p>参考<a href="https://blog.csdn.net/qq_42276808/article/details/104145927" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/qq_42276808/article/details/104145927<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>另外还有一个操作用户默认shell的命令chsh:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 查看当前系统中的可用shell，其实是列出/etc/shells</span>
chsh <span class="token parameter variable">-l</span>
<span class="token comment"># 指定当前用户的shell为bash</span>
chsh <span class="token parameter variable">-s</span> /bin/bash
<span class="token comment"># root用户下，修改其他用户的shell(适用于创建用户时未指定shell时，或者需要更改默认shell时)</span>
chsh <span class="token variable">$username</span>
</code></pre></div><p>参考<a href="https://blog.csdn.net/weixin_33860553/article/details/92670108" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/weixin_33860553/article/details/92670108<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="userdel删除用户"><a href="#userdel删除用户" class="header-anchor">#</a> userdel删除用户</h3> <ul><li>-f：强制删除用户，即使用户当前已登录；***极其dangerous！！！***即使该用户相关的home、mail spool被占用也会被删除，并且其主用户组（即使被其他用户共用）也会被删除，容易导致系统的不一致！详见<a href="https://linux.die.net/man/8/userdel" target="_blank" rel="noopener noreferrer">https://linux.die.net/man/8/userdel<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>-r：删除用户的同时，删除与用户相关的所有文件。</li></ul> <p>more：<a href="https://linux.die.net/man/8/userdel" target="_blank" rel="noopener noreferrer">https://linux.die.net/man/8/userdel<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>先终结其所有进程：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">pkill</span> <span class="token parameter variable">-u</span> <span class="token variable">$username</span>
</code></pre></div><p>再删除：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">userdel</span> <span class="token parameter variable">-r</span> <span class="token variable">$username</span> <span class="token comment"># 如果去掉-r选项，那么只删除用户，不删除相关目录（如家目录/home/$username）</span>
</code></pre></div><h3 id="passwd管理用户口令"><a href="#passwd管理用户口令" class="header-anchor">#</a> passwd管理用户口令</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">passwd</span> 选项 用户名
</code></pre></div><p>可使用的选项：</p> <ul><li>-d：清空密码，仅有系统管理者才能使用，这是禁止用户登录的一种快捷方式；</li> <li>-e：立即使用户密码过期，强制用户在下次登录时更改密码。</li> <li>-l,—lock：锁定密码，用户不能修改密码</li> <li>-S：列出密码的相关信息，仅有系统管理者才能使用；可配合-a选项使用</li> <li>-u：解开已上锁的帐号，针对-l选项。</li></ul> <p>也可当前用户执行passwd来修改当前用户的密码。</p> <p>示例：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># passwd -d linuxde  //清除linuxde用户密码；</span>
Removing password <span class="token keyword">for</span> user linuxde.
passwd: Success                         //清除成功；

<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># passwd -S linuxde    //查询linuxde用户密码状态；</span>
Empty password.                         //空密码，也就是没有密码；
</code></pre></div><h2 id="用户组管理-root权限下操作"><a href="#用户组管理-root权限下操作" class="header-anchor">#</a> 用户组管理（root权限下操作）</h2> <p>用户组的管理涉及用户组的添加、删除和修改。组的增加、删除和修改实际上就是对/etc/group文件的更新。有的翻译为工作组、群组。</p> <h3 id="groupadd创建用户组"><a href="#groupadd创建用户组" class="header-anchor">#</a> groupadd创建用户组</h3> <ul><li>-g：指定新建工作组的id；</li> <li>-r：创建系统工作组，系统工作组的组ID小于500；</li> <li>-K：覆盖配置文件“/ect/login.defs”；</li> <li>-o：允许添加组ID号不唯一的工作组。</li></ul> <p>more：<a href="https://linux.die.net/man/8/groupadd" target="_blank" rel="noopener noreferrer">https://linux.die.net/man/8/groupadd<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>示例：</p> <p>1）创建新组$group1</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">groupadd</span> <span class="token parameter variable">-g</span> <span class="token number">555</span> <span class="token variable">$group1</span>
</code></pre></div><p>此时在/etc/passwd文件中产生一个组ID（GID）是555的项目。如果不加-g选项，新组的组标识号是在当前已有的最大组标识号的基础上加1。</p> <h3 id="groupmod修改工作组"><a href="#groupmod修改工作组" class="header-anchor">#</a> groupmod修改工作组</h3> <ul><li>-g&lt;工作组识别码&gt;：修改工作组识别码gid；</li> <li>-o：允许工作组组识别码gid有其他值；</li> <li>-n&lt;新工作组名称&gt;：修改工作组名称。</li></ul> <p>示例：</p> <p>1）修改$group1的gid为666</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">groupmod</span> <span class="token parameter variable">-g</span> <span class="token number">666</span> <span class="token variable">$group1</span>
</code></pre></div><p>2）将$group1的gid设置为10000，名字改为$group2</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">groupmod</span> –g <span class="token number">10000</span> <span class="token parameter variable">-n</span> <span class="token variable">$group2</span> <span class="token variable">$group1</span>
</code></pre></div><p>3）如果一个用户同时属于多个用户组，那么用户可以在用户组之间切换，以便具有其他用户组的权限：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>newgrp <span class="token variable">$group2</span>
</code></pre></div><p>当前用户切换到$group2工作组来操作。</p> <h3 id="groupdel删除工作组"><a href="#groupdel删除工作组" class="header-anchor">#</a> groupdel删除工作组</h3> <ul><li>&lt;$groupname&gt;：删除$groupname的工作组。</li></ul> <p>示例：</p> <p>1）从系统中删除$group2，root用户执行</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">groupdel</span> <span class="token variable">$group2</span>
</code></pre></div><h2 id="各种系统用户、组信息文件"><a href="#各种系统用户、组信息文件" class="header-anchor">#</a> 各种系统用户、组信息文件</h2> <p><strong>1）与用户账号有关的系统文件/etc/passwd，存放用户主要信息，其相关字段解释如下：</strong></p> <div class="language- extra-class"><pre class="language-text"><code>用户名:口令:用户标识号:组标识号:注释性描述:主目录:登录Shell
</code></pre></div><p><strong>2）用户帐户安全文件/etc/shadow，其记录行与/etc/passwd中的一一对应</strong></p> <p>它由pwconv命令根据/etc/passwd中的数据自动产生。（由于/etc/passwd文件是所有用户都可读的，如果用户的密码太简单或规律比较明显的话，一台普通的计算机就能够很容易地将它破解，因此对安全性要求较高的Linux系统都把加密后的口令字分离出来，单独存放在一个文件中，这个文件是/etc/shadow文件。 有超级用户才拥有该文件读权限，这就保证了用户密码的安全性。）</p> <div class="language-bash extra-class"><pre class="language-bash"><code>登录名:加密口令:最后一次修改时间:最小时间间隔:最大时间间隔:警告时间:不活动时间:失效时间:标志
</code></pre></div><ol><li>&quot;登录名&quot;是与/etc/passwd文件中的登录名相一致的用户账号</li> <li>&quot;口令&quot;字段存放的是加密后的用户口令字，长度为13个字符。如果为空，则对应用户没有口令，登录时不需要口令；如果含有不属于集合 { ./0-9A-Za-z }中的字符，则对应的用户不能登录。</li> <li>&quot;最后一次修改时间&quot;表示的是从某个时刻起，到用户最后一次修改口令时的天数。时间起点对不同的系统可能不一样。例如在SCO Linux 中，这个时间起点是1970年1月1日。</li> <li>&quot;最小时间间隔&quot;指的是两次修改口令之间所需的最小天数。</li> <li>&quot;最大时间间隔&quot;指的是口令保持有效的最大天数。</li> <li>&quot;警告时间&quot;字段表示的是从系统开始警告用户到用户密码正式失效之间的天数。</li> <li>&quot;不活动时间&quot;表示的是用户没有登录活动但账号仍能保持有效的最大天数。</li> <li>&quot;失效时间&quot;字段给出的是一个绝对的天数，如果使用了这个字段，那么就给出相应账号的生存期。期满后，该账号就不再是一个合法的账号，也就不能再用来登录了。</li></ol> <p><strong>3）用户组的所有信息都存放在/etc/group文件中。</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>组名:口令:组标识号:组内用户列表
</code></pre></div><ol><li>&quot;组名&quot;是用户组的名称，由字母或数字构成。与/etc/passwd中的登录名一样，组名不应重复。</li> <li>&quot;口令&quot;字段存放的是用户组加密后的口令字。一般Linux 系统的用户组都没有口令，即这个字段一般为空，或者是*。</li> <li>&quot;组标识号&quot;与用户标识号类似，也是一个整数，被系统内部用来标识组。</li> <li>&quot;组内用户列表&quot;是属于这个组的所有用户的列表/b]，不同用户之间用逗号(,)分隔。这个用户组可能是用户的主组，也可能是附加组。</li></ol> <h2 id="实例-批量添加用户"><a href="#实例-批量添加用户" class="header-anchor">#</a> 实例：批量添加用户</h2> <p>可参考<a href="https://www.runoob.com/linux/linux-user-manage.html" target="_blank" rel="noopener noreferrer">https://www.runoob.com/linux/linux-user-manage.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中的文尾。</p> <p>另外可以先新建一个文本<code>users.list</code>，里面每一行都是要添加的用户名，然后执行如下shell脚本：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>

<span class="token keyword">for</span> <span class="token for-or-select variable">username</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">more</span> users.list<span class="token variable">)</span></span>
<span class="token keyword">do</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-n</span> <span class="token variable">$username</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
  <span class="token function">useradd</span> <span class="token parameter variable">-m</span> <span class="token variable">$username</span> <span class="token parameter variable">-d</span> /home/<span class="token variable">$username</span> <span class="token parameter variable">-s</span> /bin/bash
  <span class="token builtin class-name">echo</span>
  <span class="token assign-left variable">PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$username</span>&quot;</span>&quot;123<span class="token string">&quot;
  echo -e &quot;</span><span class="token variable">$PASSWORD</span><span class="token punctuation">\</span>n<span class="token variable">$PASSWORD</span><span class="token string">&quot; | passwd &quot;</span><span class="token variable">$username</span><span class="token string">&quot;
  echo
  echo &quot;</span>User <span class="token variable">$username</span>'s password is changed to <span class="token variable">$PASSWORD</span><span class="token operator">!</span><span class="token string">&quot;
  mkdir /data/<span class="token variable">$username</span>
  chown <span class="token variable">$username</span> /data/<span class="token variable">$username</span>
  cp /home/test/Miniconda3-py38_4.10.3-Linux-x86_64.sh /data/<span class="token variable">$username</span>
else
  echo &quot;</span>The username is null<span class="token operator">!</span>&quot;
<span class="token keyword">fi</span>
<span class="token keyword">done</span>
</code></pre></div><p>那么批量删除的shell脚本：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>

<span class="token keyword">for</span> <span class="token for-or-select variable">username</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">more</span> remove_users.list<span class="token variable">)</span></span>
<span class="token keyword">do</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-n</span> <span class="token variable">$username</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
  <span class="token function">userdel</span> <span class="token parameter variable">-r</span> <span class="token variable">$username</span>
  <span class="token builtin class-name">echo</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;User <span class="token variable">$username</span> has been deleted!&quot;</span>
  <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /data/<span class="token variable">$username</span>
<span class="token keyword">else</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;The username is null!&quot;</span>
<span class="token keyword">fi</span>
<span class="token keyword">done</span>
</code></pre></div><p>参考：</p> <p><a href="https://zhuanlan.zhihu.com/p/205217949" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/205217949<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="https://man.linuxde.net/" target="_blank" rel="noopener noreferrer">https://man.linuxde.net/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="https://linux.die.net/man/8/" target="_blank" rel="noopener noreferrer">https://linux.die.net/man/8/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="https://man7.org/linux/man-pages/man1" target="_blank" rel="noopener noreferrer">https://man7.org/linux/man-pages/man1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="https://www.runoob.com/linux/linux-user-manage.html" target="_blank" rel="noopener noreferrer">https://www.runoob.com/linux/linux-user-manage.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="https://www.cnblogs.com/xd502djj/archive/2011/11/23/2260094.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/xd502djj/archive/2011/11/23/2260094.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/zfhxi/Alchemy-Handbook/edit/main/docs/basic_operations_of_linux/Linux系统配置/03-user_add_del.md" target="_blank" rel="noopener noreferrer">Edit on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div id="vcomments"></div> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.b3fe3ba4.js" defer></script><script src="/assets/js/2.cfef0441.js" defer></script><script src="/assets/js/11.4bab1ac6.js" defer></script><script src="/assets/js/7.58b74439.js" defer></script>
  </body>
</html>
