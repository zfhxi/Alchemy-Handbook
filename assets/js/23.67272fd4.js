(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{302:function(s,t,e){"use strict";e.r(t);var n=e(10),a=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"linux配置ssh密钥对实现免密登录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux配置ssh密钥对实现免密登录"}},[s._v("#")]),s._v(" Linux配置ssh密钥对实现免密登录")]),s._v(" "),t("p",[s._v("如下操作可能不适用于惯用xshell的用户，特别是windows用户，几乎对windows用户没啥大用（除非他们摆脱xshell，然而我用windows时都不能摆脱xshell）。对于Mac/Linux下惯用终端连接服务器的用户可能相对地提高效率。")]),s._v(" "),t("p",[s._v("参考自："),t("a",{attrs:{href:"https://p3terx.com/archives/configuring-ssh-keys-with-sshkeygen-and-sshcopyid.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://p3terx.com/archives/configuring-ssh-keys-with-sshkeygen-and-sshcopyid.html"),t("OutboundLink")],1)]),s._v(" "),t("ol",[t("li",[t("p",[s._v("在本地终端中执行 "),t("code",[s._v("ssh-keygen")]),s._v("，生成密钥对（私钥和公钥），（除了修改"),t("code",[s._v("Enter file in which to save the key (/home/xxxx/.ssh/id_rsa):")]),s._v("，建议改为"),t("code",[s._v("/home/xxxx/.ssh/服务器名_rsa")]),s._v("，方便区分）一路回车 (En­ter)。")])]),s._v(" "),t("li",[t("p",[s._v("假如1中~/.ssh下生成了amax_rsa.pub和amax_ras文件")])]),s._v(" "),t("li",[t("p",[s._v("使用 "),t("code",[s._v("ssh-copy-id")]),s._v(" 自动将公钥上传并配置到 服务器上，"),t("code",[s._v("ssh-copy-id -i ~/.ssh/amax_rsa.pub User@HostName -p Port")])])]),s._v(" "),t("li",[t("p",[s._v("使用 SSH 配置文件管理会话，本地"),t("code",[s._v("vim ~/.ssh/config")]),s._v("：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("Host amax\n    HostName "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("233.233")]),s._v(".233.233\n    Port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2333")]),s._v("\n    User myvps\n    IdentityFile "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"~/.ssh/amax_rsa"')]),s._v("\n    IdentitiesOnly "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n")])])]),t("p",[s._v("然后赋予权限"),t("code",[s._v("chmod 600 ~/.ssh/config")])])]),s._v(" "),t("li",[t("p",[s._v("终端直接"),t("code",[s._v("ssh amax")]),s._v("实现免密登录。甚至可以方便执行"),t("code",[s._v("sftp amax")]),s._v("，来进行服务器间的文件传输。这种配置也方便vscode+remote ssh打开远程服务器。")])])]),s._v(" "),t("p",[s._v("windows下的免密配置：<"),t("a",{attrs:{href:"https://segmentfault.com/a/1190000023054090",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://segmentfault.com/a/1190000023054090"),t("OutboundLink")],1),s._v(">")]),s._v(" "),t("p",[s._v("设备1已经完成免密操作，直接拷贝私钥文件到其他设备（设备2），SSH配置文件写入信息，可以直接完成免密操作")]),s._v(" "),t("p",[s._v("但是需要将拷贝后的私钥文件权限修改"),t("code",[s._v("chmod 600 id_rsa")])]),s._v(" "),t("p",[s._v("若还需要密码，见"),t("a",{attrs:{href:"https://blog.csdn.net/silentwolfyh/article/details/83656101",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://blog.csdn.net/silentwolfyh/article/details/83656101"),t("OutboundLink")],1),s._v("：")]),s._v(" "),t("p",[s._v("尝试修改配置"),t("code",[s._v("/etc/ssh/sshd_config")]),s._v("：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#禁用root账户登录，如果是用root用户登录请开启 ")]),s._v("\nPermitRootLogin "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v(" \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否让 sshd 去检查用户家目录或相关档案的权限数据， ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这是为了担心使用者将某些重要档案的权限设错，可能会导致一些问题所致。 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 例如使用者的 ~.ssh/ 权限设错时，某些特殊情况下会不许用户登入 ")]),s._v("\nStrictModes no \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否允许用户自行使用成对的密钥系统进行登入行为，仅针对 version 2。 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 至于自制的公钥数据就放置于用户家目录下的 .ssh/authorized_keys 内 ")]),s._v("\nRSAAuthentication "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v(" \nPubkeyAuthentication "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v(" \nAuthorizedKeysFile .ssh/authorized_keys \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 有了证书登录了，可以选择禁用密码登录，但此处仍然保留。 ")]),s._v("\nPasswordAuthentication "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n")])])])])}),[],!1,null,null,null);t.default=a.exports}}]);